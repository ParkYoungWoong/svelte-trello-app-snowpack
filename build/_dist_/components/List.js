import"./List.css.proxy.js";import{SvelteComponent as G,append as u,attr as b,binding_callbacks as J,check_outros as K,create_component as w,destroy_component as C,detach as F,element as v,empty as N,group_outros as O,init as P,insert as q,mount_component as D,outro_and_destroy_block as Q,safe_not_equal as R,set_data as U,space as j,text as H,transition_in as L,transition_out as $,update_keyed_each as V}from"../../web_modules/svelte/internal.js";import W from"../../web_modules/sortablejs.js";import{onMount as X}from"../../web_modules/svelte.js";import{cards as Y}from"../store/list.js";import Z from"./Card.js";import x from"./CreateCard.js";import tt from"./ListTitle.js";function z(i,o,l){const s=i.slice();return s[6]=o[l],s}function A(i,o){let l,s,n;return s=new Z({props:{listId:o[0].id,card:o[6]}}),s.$on("editMode",o[2]),{key:i,first:null,c(){l=N(),w(s.$$.fragment),this.first=l},m(r,d){q(r,l,d),D(s,r,d),n=!0},p(r,d){const f={};d&1&&(f.listId=r[0].id),d&1&&(f.card=r[6]),s.$set(f)},i(r){if(n)return;L(s.$$.fragment,r),n=!0},o(r){$(s.$$.fragment,r),n=!1},d(r){r&&F(l),C(s,r)}}}function et(i){let o,l,s,n,r,d,f=i[0].cards.length+"",p,a,S,m,c=[],M=new Map,I,y,g,h;n=new tt({props:{list:i[0]}}),n.$on("editMode",i[2]);let k=i[0].cards;const T=t=>t[6].id;for(let t=0;t<k.length;t+=1){let e=z(i,k,t),_=T(e);M.set(_,c[t]=A(_,e))}return g=new x({props:{listId:i[0].id}}),g.$on("editMode",i[2]),{c(){o=v("div"),l=v("div"),s=v("div"),w(n.$$.fragment),r=j(),d=v("p"),p=H(f),a=H(" cards"),S=j(),m=v("div");for(let t=0;t<c.length;t+=1)c[t].c();y=j(),w(g.$$.fragment),b(d,"class","svelte-123sh2g"),b(s,"class","list__heading svelte-123sh2g"),b(m,"data-list-id",I=i[0].id),b(m,"class","list__cards svelte-123sh2g"),b(l,"class","list__inner svelte-123sh2g"),b(o,"class","list svelte-123sh2g")},m(t,e){q(t,o,e),u(o,l),u(l,s),D(n,s,null),u(s,r),u(s,d),u(d,p),u(d,a),u(l,S),u(l,m);for(let _=0;_<c.length;_+=1)c[_].m(m,null);i[4](m),u(l,y),D(g,l,null),h=!0},p(t,[e]){const _={};if(e&1&&(_.list=t[0]),n.$set(_),(!h||e&1)&&f!==(f=t[0].cards.length+"")&&U(p,f),e&5){const B=t[0].cards;O(),c=V(c,e,T,1,t,B,M,m,Q,A,null,z),K()}(!h||e&1&&I!==(I=t[0].id))&&b(m,"data-list-id",I);const E={};e&1&&(E.listId=t[0].id),g.$set(E)},i(t){if(h)return;L(n.$$.fragment,t);for(let e=0;e<k.length;e+=1)L(c[e]);L(g.$$.fragment,t),h=!0},o(t){$(n.$$.fragment,t);for(let e=0;e<c.length;e+=1)$(c[e]);$(g.$$.fragment,t),h=!1},d(t){t&&F(o),C(n);for(let e=0;e<c.length;e+=1)c[e].d();i[4](null),C(g)}}}function st(i,o,l){let{list:s}=o,{sortableLists:n}=o,r,d;function f(a){n.option("disabled",a.detail),r.option("disabled",a.detail)}X(()=>{r=new W(d,{group:"My Cards",handle:".card",delay:50,animation:0,forceFallback:!0,onEnd(a){Y.reorder({fromListId:a.from.dataset.listId,toListId:a.to.dataset.listId,oldIndex:a.oldIndex,newIndex:a.newIndex})}})});function p(a){J[a?"unshift":"push"](()=>{d=a,l(1,d)})}return i.$$set=a=>{"list"in a&&l(0,s=a.list),"sortableLists"in a&&l(3,n=a.sortableLists)},[s,d,f,n,p]}class lt extends G{constructor(i){super();P(this,i,st,et,R,{list:0,sortableLists:3})}}export default lt;
